# git2txt Exporter

This is a simple Python script that extracts all of the text in files from either a local directory or remote GitHub repository (by cloning) or a local directory. The script extracts the context of the files recursively and flattens them into a single file that is easy for ingestion into a LLM. 

## How It Works

1. **Argument Parsing**
   - Accepts `--repo-url` or `--local-dir` as main input sources
   - Supports optional flags for branch, token, and output customization
   - Validates GitHub URLs and directory paths

2. **Repository/Directory Handling**
   - For `--repo-url`: Clones repository using GitPython
   - For `--local-dir`: Scans local directory structure
   - Handles both public and private repositories with token authentication
   - Automatically manages temporary clones and cleanup

3. **File Processing**
   - Recursively scans all files in the directory
   - Detects text files using MIME types and extensions
   - Skips binary files, test files, and hidden files
   - Preserves directory structure information
   - Captures Git commit history when available

4. **Output Generation**
   - Creates a single consolidated text file with:
     - Directory structure visualization
     - File contents with clear separators
     - Git commit information (when available)
     - File statistics (characters, lines, tokens)
   - Stores exports in `exports/` directory
   - Writes detailed logs to `logs/` directory

5. **Security & Error Handling**
   - Masks sensitive tokens in logs
   - Uses HTTPS for authenticated requests
   - Provides comprehensive error messages
   - Maintains detailed logging with timestamps

## Example: Before & After

**Directory Structure**:
```
my_project/
├── main.py
└── utils.py
```

**Command**:
```bash
python git2txt.py --local-dir my_project
```

**Output Snippet**:
```
Generated by git2txt
================================================================================

Directory Structure:
------------------
└── main.py
└── utils.py

================================================================================

File: /path/to/my_project/main.py
----------------------------------------------------------------
Last Commit: ...
```

## Features

### Automatic Dependency Management
- Installs all dependencies quietly on first run

### Flexible Input Sources
- Remote GitHub repositories (public or private)
- Local Git repositories (with commit history)
- Local directories (non-Git)

### Smart URL Parsing
- Intelligently handles various GitHub URL formats:
  - Basic repository URLs (`https://github.com/owner/repo`)
  - Git URLs (`https://github.com/owner/repo.git`)
  - Deep URLs (`https://github.com/owner/repo/tree/main/docs`, `/pulls`, `/issues`)
- Automatically extracts base repository URL from deep URLs
- Supports subdirectory processing with --repo-url-sub flag (must come before URL)
- All flags must be specified before the repository URL
- Run `python git2txt.py --help` to see all available options

## Installation

There are two ways to install and use git2txt:

### Option A: Development Installation

1. Clone the repository:
```bash
git clone https://github.com/michaeljabbour/git2txt.git
cd git2txt
```

2. (Optional) Create and activate a virtual environment:
```bash
python -m venv venv
source venv/bin/activate  # or .\venv\Scripts\activate on Windows
```

3. Install in development mode:
```bash
pip install -e .
```
This installs git2txt as a package and includes development dependencies.

### Option B: Direct Script Usage

Simply clone and run:
```bash
git clone https://github.com/michaeljabbour/git2txt.git
cd git2txt
python git2txt.py --repo-url https://github.com/owner/repo.git
```

Note: The script will automatically install GitPython if it's not already available.

## Quick Start Usage

You can run `git2txt.py` directly without installing anything else, as the script handles dependencies automatically. Below are common usage patterns:

### 1. Export From a Remote GitHub Repo

Basic usage:
```bash
python git2txt.py --repo-url https://github.com/owner/repo.git
```

Deep URL handling:
```bash
# Export from repository root (automatically extracts base repository):
python git2txt.py https://github.com/owner/repo/pulls
python git2txt.py https://github.com/owner/repo/tree/main/docs
python git2txt.py https://github.com/owner/repo/issues

# Export from specific subdirectory (use --repo-url-sub flag):
python git2txt.py --repo-url-sub https://github.com/owner/repo/tree/main/docs
```

Optional: Specify a branch or commit (flags must come before URL):
```bash
python git2txt.py --branch dev https://github.com/owner/repo.git
```

Private Repos: Provide your Personal Access Token (flags must come before URL):
```bash
python git2txt.py --token YOUR_TOKEN https://github.com/owner/private-repo.git
```

Skip Removing the Clone: Keep the cloned repo after export (for debugging):
```bash
python git2txt.py --skip-remove https://github.com/owner/repo.git
```

### 2. Export From a Local Directory

```bash
python git2txt.py --local-dir /path/to/local/project
```

- If the directory contains a `.git` folder, git2txt will attempt to gather commit info for each file
- If not, it still processes files but omits commit data

### 3. Custom Output Filename

```bash
python git2txt.py --output-file my_export.txt https://github.com/owner/repo.git
```

This places the file in `exports/my_export.txt`.

## Development

After cloning, you can edit `git2txt.py` or the supporting modules. We recommend using a virtual environment and the pytest library for testing.

### Code Style

We use Black for code formatting to maintain consistent style. To format the code:

```bash
# Install Black (if not already installed)
pip install black

# Format all Python files
black .
```

The project is configured with Black settings in `pyproject.toml`, including a line length of 100 characters and Python 3.7+ compatibility.

For help, please check the GitHub issues page or open a new issue.
