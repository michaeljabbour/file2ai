# file2ai

A comprehensive tool for file conversion, text extraction, and AI processing. This tool can extract text from Git repositories, local directories, and convert files between various formats, making it easy to prepare data for AI model ingestion.

## How It Works

1. **Argument Parsing**
   - Accepts `--repo-url` or `--local-dir` as main input sources
   - Supports optional flags for branch, token, and output customization
   - Validates GitHub URLs and directory paths

2. **Repository/Directory Handling**
   - For `--repo-url`: Clones repository using GitPython
   - For `--local-dir`: Scans local directory structure
   - Handles both public and private repositories with token authentication
   - Automatically manages temporary clones and cleanup

3. **File Processing**
   - Recursively scans all files in the directory
   - Detects text files using MIME types and extensions
   - Skips binary files, test files, and hidden files
   - Preserves directory structure information
   - Captures Git commit history when available

4. **Output Generation**
   - Creates a single consolidated text file with:
     - Directory structure visualization
     - File contents with clear separators
     - Git commit information (when available)
     - File statistics (characters, lines, tokens)
   - Stores exports in `exports/` directory
   - Writes detailed logs to `logs/` directory

5. **Security & Error Handling**
   - Masks sensitive tokens in logs
   - Uses HTTPS for authenticated requests
   - Provides comprehensive error messages
   - Maintains detailed logging with timestamps

## Example: Before & After

**Directory Structure**:
```
my_project/
├── main.py
└── utils.py
```

**Command**:
```bash
python file2ai.py --local-dir my_project
```

**Output Snippet**:
```
Generated by file2ai
================================================================================

Directory Structure:
------------------
└── main.py
└── utils.py

================================================================================

File: /path/to/my_project/main.py
----------------------------------------------------------------
Last Commit: ...
```

## Features

### Automatic Dependency Management
- Installs all dependencies quietly on first run

### Flexible Input Sources
- Remote GitHub repositories (public or private)
- Local Git repositories (with commit history)
- Local directories (non-Git)

### Smart URL Parsing
- Intelligently handles various GitHub URL formats:
  - Basic repository URLs (`https://github.com/owner/repo`)
  - Git URLs (`https://github.com/owner/repo.git`)
  - Deep URLs (`https://github.com/owner/repo/tree/main/docs`, `/pulls`, `/issues`)
- Automatically extracts base repository URL from deep URLs
- Supports subdirectory processing with --repo-url-sub flag (must come before URL)
- All flags must be specified before the repository URL
- Run `python file2ai.py --help` to see all available options

## Installation

There are two ways to install and use file2ai:

### Option A: Development Installation

1. Clone the repository:
```bash
git clone https://github.com/michaeljabbour/file2ai.git
cd file2ai
```

2. (Optional) Create and activate a virtual environment:
```bash
python -m venv venv
source venv/bin/activate  # or .\venv\Scripts\activate on Windows
```

3. Install in development mode:
```bash
pip install -e .
```
This installs file2ai as a package and includes development dependencies.

### Option B: Direct Script Usage

Simply clone and run:
```bash
git clone https://github.com/michaeljabbour/file2ai.git
cd file2ai
python file2ai.py --repo-url https://github.com/owner/repo.git
```

Note: The script will automatically install GitPython if it's not already available.

## Quick Start Usage

You can run `file2ai.py` directly without installing anything else, as the script handles dependencies automatically. Below are common usage patterns:

### 1. Export From a Remote GitHub Repo

Basic usage:
```bash
python file2ai.py --repo-url https://github.com/owner/repo.git
```

Deep URL handling:
```bash
# Export from repository root (automatically extracts base repository):
python file2ai.py https://github.com/owner/repo/pulls
python file2ai.py https://github.com/owner/repo/tree/main/docs
python file2ai.py https://github.com/owner/repo/issues

# Export from specific subdirectory (use --repo-url-sub flag):
python file2ai.py --repo-url-sub https://github.com/owner/repo/tree/main/docs
```

Optional: Specify a branch or commit (flags must come before URL):
```bash
python file2ai.py --branch dev https://github.com/owner/repo.git
```

Private Repos: Provide your Personal Access Token (flags must come before URL):
```bash
python file2ai.py --token YOUR_TOKEN https://github.com/owner/private-repo.git
```

Skip Removing the Clone: Keep the cloned repo after export (for debugging):
```bash
python file2ai.py --skip-remove https://github.com/owner/repo.git
```

### 2. Export From a Local Directory

```bash
python file2ai.py --local-dir /path/to/local/project
```

- If the directory contains a `.git` folder, file2ai will attempt to gather commit info for each file
- If not, it still processes files but omits commit data

### 3. Custom Output Filename

```bash
python file2ai.py --output-file my_export.txt https://github.com/owner/repo.git
```

This places the file in `exports/my_export.txt`.

### 4. Document Conversion

file2ai supports converting between various document formats using pure Python implementations. You can use either the direct file path method or the `convert` subcommand:

```bash
# Direct file path method (simplest):
python file2ai.py document.pdf                    # Converts to text by default
python file2ai.py document.docx --format pdf      # Specify output format
python file2ai.py document.xlsx --format csv      # Convert Excel to CSV

# Using convert subcommand (more options):
python file2ai.py convert --input document.pdf --format text

# Using the web interface:
python file2ai.py serve                          # Access at http://localhost:8000
```

#### Supported Formats and Examples

1. **PDF Documents**
   ```bash
   # Convert PDF to text (with page selection)
   python file2ai.py sample.pdf --pages "1-3,5"
   python file2ai.py convert --input sample.pdf --format text --pages "1,3,5-7"

   # Convert PDF to images
   python file2ai.py sample.pdf --format image --resolution 300
   ```

2. **Microsoft Word (DOC/DOCX)**
   ```bash
   # Convert Word to text
   python file2ai.py document.docx
   
   # Convert Word to PDF
   python file2ai.py document.docx --format pdf
   ```

3. **Microsoft Excel (XLS/XLSX)**
   ```bash
   # Convert Excel to CSV
   python file2ai.py spreadsheet.xlsx --format csv
   
   # Convert Excel to text (preserves formatting)
   python file2ai.py spreadsheet.xlsx --format text
   ```

4. **PowerPoint (PPT/PPTX)**
   ```bash
   # Convert PowerPoint to images (one per slide)
   python file2ai.py slides.pptx --format image
   
   # Convert with image quality settings
   python file2ai.py slides.pptx --format image --quality 90 --resolution 300
   ```

5. **HTML/MHTML**
   ```bash
   # Convert HTML to text (strips formatting)
   python file2ai.py webpage.html
   
   # Convert HTML to PDF
   python file2ai.py webpage.html --format pdf
   ```

#### Advanced Options

1. **Image Processing Options**
   ```bash
   # Default enhancement (recommended settings)
   python file2ai.py document.pdf --format image
   # Automatically applies optimal values:
   # - Brightness: 1.50 (enhanced readability)
   # - Contrast: 1.20 (improved clarity)
   
   # Custom adjustments (range: 0.0-2.0)
   python file2ai.py document.pdf --format image --brightness 1.2 --contrast 1.1
   
   # Set image quality and resolution
   python file2ai.py slides.pptx --format image --quality 95 --resolution 300
   ```

2. **Output Control**
   ```bash
   # Specify custom output path
   python file2ai.py document.pdf --output custom_name.text
   
   # Default: files are saved in exports/ directory
   python file2ai.py document.docx  # Creates exports/document.text
   ```

#### Format-Specific Features

- **PDF Processing**
  - Page range selection with flexible syntax (e.g., "1-3,5,7-9")
  - High-quality text extraction with layout preservation
  - Image export with customizable resolution

- **Office Documents**
  - Maintains document structure when converting to text
  - Preserves tables and formatting in Excel conversions
  - Supports batch image export for PowerPoint slides

- **Image Processing**
  - Adjustable brightness and contrast
  - Quality control for compression (1-100)
  - Custom resolution settings (DPI)

Note: All converted files are saved in the `exports/` directory by default. Use the `--output` option to specify a custom location.

### Web Interface

file2ai includes a web interface for easy file uploads and conversions:

```bash
# Start the web server
python file2ai.py serve

# Or specify a custom port
python file2ai.py serve --port 8080
```

The web interface provides:
- Drag-and-drop file uploads
- Real-time conversion progress
- Multiple format conversion options
- Batch processing capabilities
- Download converted files directly

### Cross-Platform Compatibility

file2ai is designed to work across different platforms:
- Pure Python implementation for core features
- No system-level dependencies required
- Tested on Python 3.11 and 3.12
- 47% test coverage with comprehensive test suite

### Image Processing Features

1. **Enhanced Image Quality**
   ```bash
   # Default enhancement settings
   python file2ai.py document.pdf --format image
   # Uses optimal values (brightness: 1.50, contrast: 1.20)
   
   # Custom enhancement
   python file2ai.py document.pdf --format image --brightness 1.3 --contrast 1.1
   ```

2. **Pure Python Conversion**
   - Native Word to image conversion without external dependencies
   - Consistent output across platforms
   - Automatic image optimization

## Development

After cloning, you can edit `file2ai.py` or the supporting modules. We recommend using a virtual environment and the pytest library for testing.

### Testing

Run the test suite to verify functionality:

```bash
# Install test dependencies
pip install -e ".[test]"

# Run tests
pytest

# Run with coverage
pytest --cov=file2ai
```

Current test coverage: 47% (verified with comprehensive test suite)

### Code Style

We use Black for code formatting to maintain consistent style. To format the code:

```bash
# Install Black (if not already installed)
pip install black

# Format all Python files
black .
```

The project is configured with Black settings in `pyproject.toml`, including a line length of 100 characters and Python 3.11+ compatibility.

For help, please check the GitHub issues page or open a new issue.
